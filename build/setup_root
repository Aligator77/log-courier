#!/bin/bash

# Allow 'go get' to see we already have the log-courier packages by setting
# up a rough Go workspace.

if [ "$OS" = "Windows_NT" ]; then
  # Windows lacks symlinks and MinGW 'ln' fails with 'Permission denied' as it
  # tries to copy a folder into a subfolder of itself, copying nothing, so 'cp'
  # manually.
  rm -rf src/github.com/driskell/log-courier
  mkdir -p src/github.com/driskell/log-courier
  cp -rf {.git,src} src/github.com/driskell/log-courier/
else
  mkdir -p src/github.com/driskell
  ln -nsf ../../.. src/github.com/driskell/log-courier
fi

# Fake a .git folder for downloaded archives to avoid 'go get' 'Stale checkout'
if [ ! -d src/github.com/driskell/log-courier/.git ]; then
  mkdir src/github.com/driskell/log-courier/.git
fi
